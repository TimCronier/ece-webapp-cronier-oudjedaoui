(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[977],{6473:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/articles/[id]",function(){return n(5148)}])},9268:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(5893),r=n(8214),a=n.n(r),c=n(4053);function i(e){var t=e.email;return(0,c.useSession)()?(0,s.jsx)("img",{src:"https://www.gravatar.com/avatar/"+a()(t),class:"round"}):(0,s.jsx)(s.Fragment,{})}},5148:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return d},default:function(){return m}});var s=n(7568),r=n(655),a=n(5893),c=(0,n(9802).eI)("http://localhost:8000","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJhbm9uIiwKICAgICJpc3MiOiAic3VwYWJhc2UtZGVtbyIsCiAgICAiaWF0IjogMTY0MTc2OTIwMCwKICAgICJleHAiOiAxNzk5NTM1NjAwCn0.dc_X5iR_VP_qT0zsiyj_I_OZ2T9FtRU2BBNWN8Bu4GE"),i=n(9268),l=n(7294),o=n(4053);function u(e){var t=e.id,n=(0,o.useSupabaseClient)(),c=(0,l.useState)(),i=c[0],u=c[1];function d(){return(d=(0,s.Z)(function(){var e,s,a,c,i;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,n.from("profiles").select("username").eq("id",t).single()];case 1:if(s=(e=r.sent()).data,a=e.error,c=e.status,a&&406!==c)throw a;return s&&u(s.username),[3,3];case 2:return i=r.sent(),console.log(i),[3,3];case 3:return[2]}})})).apply(this,arguments)}return(0,l.useEffect)(function(){!function(){return d.apply(this,arguments)}()}),(0,a.jsx)("span",{class:"commentUsername",children:i})}var d=!0;function m(e){var t=e.post,n=(0,o.useSession)(),d=(0,l.useState)(),m=d[0],h=d[1],p=(0,l.useState)("0 (100 max)");p[0],p[1];var x=(0,l.useState)("0 (1000 max)");x[0],x[1];var j=(0,l.useState)(),g=j[0],f=j[1];function _(){return(_=(0,s.Z)(function(e){var t,n;return(0,r.__generator)(this,function(s){switch(s.label){case 0:t=e.id,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.from("comments").delete().eq("id",t)];case 2:return s.sent().data,alert("Your comment was deleted !"),[3,4];case 3:return n=s.sent(),console.log(n),[3,4];case 4:return[2]}})})).apply(this,arguments)}function v(){return(v=(0,s.Z)(function(){var e;return(0,r.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,c.from("comments").insert({author_id:n.user.id,content:g,created_at:new Date().toISOString(),article_id:t.id,author_email:n.user.email})];case 1:return s.sent().data,[3,3];case 2:return e=s.sent(),console.log(e),[3,3];case 3:return f(null),[2]}})})).apply(this,arguments)}return(0,l.useEffect)(function(){function e(){return(e=(0,s.Z)(function(){var e,n;return(0,r.__generator)(this,function(e){switch(e.label){case 0:return[4,c.from("comments").select("*").eq("article_id",t.id).order("created_at",{ascending:!1})];case 1:return h(e.sent().data),[2]}})})).apply(this,arguments)}!function(){return e.apply(this,arguments)}()}),n?(0,a.jsxs)("div",{style:{minHeight:"81.3vh"},class:"articleWrapper",children:[(0,a.jsx)("p",{class:"articleTitle",children:t.title}),(0,a.jsx)("div",{class:"articleImage",children:(0,a.jsx)("img",{src:t.source,class:"articleImg",style:{width:"600px",height:"600px"}})}),(0,a.jsxs)("div",{class:"articleContent",children:[" ",t.content," "]}),(0,a.jsxs)("div",{class:"globalWrapper",children:[(0,a.jsx)("div",{class:"commentWrapper",children:m?m.map(function(e){return(0,a.jsxs)("div",{class:e.author_id===n.user.id?"commentsAuthor":"comments",children:[(0,a.jsx)("div",{class:"commentImage",children:(0,a.jsx)(i.Z,{email:e.author_email})}),(0,a.jsxs)("div",{class:"commentContent",children:[(0,a.jsx)(u,{id:e.author_id})," ",(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{children:e.content})," ",(0,a.jsx)("br",{}),(0,a.jsx)("span",{class:"commentDate",children:new Date(e.created_at).getDate()+"/"+(new Date(e.created_at).getMonth()+1)+"/"+new Date(e.created_at).getFullYear()+" | "+(new Date(e.created_at).getHours()+1)+":"+new Date(e.created_at).getMinutes()})," ",(0,a.jsx)("br",{}),e.author_id===n.user.id?(0,a.jsx)("button",{onClick:function(){return function(e){return _.apply(this,arguments)}(e)},class:"commentsAuthorEditImage",children:(0,a.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/4662/4662653.png"})}):(0,a.jsx)(a.Fragment,{})]})]},e.id)}):(0,a.jsx)(a.Fragment,{})}),(0,a.jsxs)("div",{class:"writeCommentWrapper",children:[(0,a.jsx)("textarea",{value:g||"",onChange:function(e){return f(e.target.value)},class:"writeComment"}),(0,a.jsx)("button",{onClick:function(){return function(){return v.apply(this,arguments)}()},class:"submitForm",children:(0,a.jsx)("span",{children:"Post comment"})})]})]})]}):(0,a.jsxs)("div",{style:{minHeight:"81.3vh"},class:"articleWrapper",children:[(0,a.jsx)("p",{class:"articleTitle",children:t.title}),(0,a.jsx)("div",{class:"articleImage",children:(0,a.jsx)("img",{src:t.source,class:"articleImg",style:{width:"600px",height:"600px"}})}),(0,a.jsxs)("div",{class:"articleContent",children:[" ",t.content," "]}),(0,a.jsx)("div",{class:"commentWrapper",children:m?m.map(function(e){return(0,a.jsxs)("div",{class:"comments",children:[(0,a.jsx)("div",{class:"commentImage",children:(0,a.jsx)(i.Z,{email:e.author_email})}),(0,a.jsxs)("div",{class:"commentContent",children:[(0,a.jsx)(u,{id:e.author_id})," ",(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{children:e.content})," ",(0,a.jsx)("br",{}),(0,a.jsx)("span",{class:"commentDate",children:new Date(e.created_at).getSeconds()})," ",(0,a.jsx)("br",{})]})]},e.id)}):(0,a.jsx)(a.Fragment,{})}),(0,a.jsx)("div",{class:"writeComment"}),comment.author_id===n.user.id?(0,a.jsx)("button",{class:"commentsAuthorEditImage",children:(0,a.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/3756/3756522.png"})}):(0,a.jsx)(a.Fragment,{})]})}},2480:function(){}},function(e){e.O(0,[214,774,888,179],function(){return e(e.s=6473)}),_N_E=e.O()}]);