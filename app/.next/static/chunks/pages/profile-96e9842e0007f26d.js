(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9344:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return r(7317)}])},9268:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5893),s=r(8214),u=r.n(s),a=r(4053);function i(e){var t=e.email;return(0,a.useSession)()?(0,n.jsx)("img",{src:"https://www.gravatar.com/avatar/"+u()(t),class:"round"}):(0,n.jsx)(n.Fragment,{})}},7317:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(7568),s=r(655),u=r(5893),a=r(7294),i=r(4053),l=r(1163),c=r(9268);function o(e){var t=e.session,r=(0,i.useSupabaseClient)(),l=(0,i.useUser)(),o=(0,a.useState)(!0),f=o[0],d=o[1],p=(0,a.useState)(null),h=p[0],m=p[1],b=(0,a.useState)(null),x=b[0],j=b[1],g=(0,a.useState)(null),_=g[0];function v(){return(v=(0,n.Z)(function(){var e,t,n,u,a;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,3,4]),d(!0),[4,r.from("profiles").select("username").eq("id",l.id).single()];case 1:if(t=(e=s.sent()).data,n=e.error,u=e.status,n&&406!==u)throw n;return t&&m(t.username),[3,4];case 2:return a=s.sent(),console.log(a),[3,4];case 3:return d(!1),[7];case 4:return[2]}})})).apply(this,arguments)}function w(){return(w=(0,n.Z)(function(e){var t,n,u,a;return(0,s.__generator)(this,function(s){switch(s.label){case 0:t=e.username,e.website,e.avatar_url,s.label=1;case 1:return s.trys.push([1,3,4,5]),d(!0),n={id:l.id,username:t,updated_at:new Date().toISOString()},[4,r.from("profiles").upsert(n)];case 2:if(u=s.sent().error)throw u;return alert("Profile updated!"),[3,5];case 3:return a=s.sent(),alert("Error updating the data!"),console.log(a),[3,5];case 4:return d(!1),[7];case 5:return[2]}})})).apply(this,arguments)}return g[1],(0,a.useEffect)(function(){(function(){v.apply(this,arguments)})()},[t]),(0,u.jsxs)("div",{class:"form",children:[(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),(0,u.jsx)("label",{htmlFor:"email",children:"Email : "}),(0,u.jsx)("input",{type:"email",value:t.user.email,disabled:!0}),(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),(0,u.jsx)("label",{htmlFor:"username",children:"Username : "}),(0,u.jsx)("input",{type:"text",value:h||"",onChange:function(e){return m(e.target.value)}}),(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),(0,u.jsx)("label",{htmlFor:"website",children:"Message : "}),(0,u.jsx)("input",{type:"text",value:x||"",onChange:function(e){return j(e.target.value)}}),(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),(0,u.jsx)("div",{children:(0,u.jsx)("button",{class:"submitForm",onClick:function(){return function(e){return w.apply(this,arguments)}({username:h,website:x,avatar_url:_})},disabled:f,children:f?"Loading ...":"Update"})}),(0,u.jsx)("div",{children:(0,u.jsx)("button",{class:"submitForm",onClick:function(){return r.auth.signOut()},children:"Sign Out"})}),(0,u.jsx)(c.Z,{email:t.user.email})]})}function f(){var e=(0,l.useRouter)(),t=(0,i.useSession)(),r=(0,i.useSupabaseClient)();return(0,a.useEffect)(function(){function u(){return(u=(0,n.Z)(function(){var e,n,u;return(0,s.__generator)(this,function(s){switch(s.label){case 0:if(!t)return[3,3];return[4,r.from("profiles").select("email").eq("id",t.user.id).single()];case 1:if(n=(e=s.sent()).data,u=e.error)throw u;if(n.email)return[3,3];return[4,r.from("profiles").update({email:t.user.email}).eq("id",t.user.id)];case 2:s.sent(),s.label=3;case 3:return[2]}})})).apply(this,arguments)}t||e.push("/login"),!function(){return u.apply(this,arguments)}()}),(0,u.jsxs)("div",{className:"container",style:{padding:"50px 0 100px 0"},children:[t?(0,u.jsx)(o,{session:t}):(0,u.jsx)("p",{children:"caca"}),(0,u.jsx)("button",{onClick:(0,n.Z)(function(){return(0,s.__generator)(this,function(e){return data.email?alert("caca pas null"):alert("caca null"),[2]})}),children:"zebi"})]})}},1163:function(e,t,r){e.exports=r(387)},2480:function(){}},function(e){e.O(0,[214,774,888,179],function(){return e(e.s=9344)}),_N_E=e.O()}]);